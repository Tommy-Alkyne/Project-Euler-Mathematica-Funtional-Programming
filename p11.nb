(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14552,        358]
NotebookOptionsPosition[     13514,        331]
NotebookOutlinePosition[     13932,        348]
CellTagsIndexPosition[     13889,        345]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Problem 11. Largest Product in a Grid", "Subtitle",
 CellChangeTimes->{{3.950772489361154*^9, 
  3.9507725066000443`*^9}},ExpressionUUID->"5375cdb0-f16a-7c48-91d5-\
babd7a532756"],

Cell["\<\
This could be written in one row, but that would be extremely hard to read, \
so I parted it a little. \
\>", "Text",
 CellChangeTimes->{{3.950829799424284*^9, 
  3.950829844210415*^9}},ExpressionUUID->"554fe388-7949-4b44-b581-\
0483b238dbf1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"s", "=", 
   InterpretationBox[
    DynamicModuleBox[{Typeset`open = False}, 
     TemplateBox[{"String", "StringIcon", 
       GridBox[{{
          RowBox[{
            TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["String", "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"String length: \"", "IconizedLabel"], 
            "\[InvisibleSpace]", 
            TagBox["1199", "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["1280", "IconizedItem"]}]}}, 
        GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
        "Column", 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
       Dynamic[Typeset`open]},
      "IconizedObject"]],
    "08 02 22 97 38 15 00 40 00 75 04 05 07 78 52 12 50 77 91 08\n49 49 99 40 \
17 81 18 57 60 87 17 40 98 43 69 48 04 56 62 00\n81 49 31 73 55 79 14 29 93 \
71 40 67 53 88 30 03 49 13 36 65\n52 70 95 23 04 60 11 42 69 24 68 56 01 32 \
56 71 37 02 36 91\n22 31 16 71 51 67 63 89 41 92 36 54 22 40 40 28 66 33 13 \
80\n24 47 32 60 99 03 45 02 44 75 33 53 78 36 84 20 35 17 12 50\n32 98 81 28 \
64 23 67 10 26 38 40 67 59 54 70 66 18 38 64 70\n67 26 20 68 02 62 12 20 95 \
63 94 39 63 08 40 91 66 49 94 21\n24 55 58 05 66 73 99 26 97 17 78 78 96 83 \
14 88 34 89 63 72\n21 36 23 09 75 00 76 44 20 45 35 14 00 61 33 97 34 31 33 \
95\n78 17 53 28 22 75 31 67 15 94 03 80 04 62 16 14 09 53 56 92\n16 39 05 42 \
96 35 31 47 55 58 88 24 00 17 54 24 36 29 85 57\n86 56 00 48 35 71 89 07 05 \
44 44 37 44 60 21 58 51 54 17 58\n19 80 81 68 05 94 47 69 28 73 92 13 86 52 \
17 77 04 89 55 40\n04 52 08 83 97 35 99 16 07 97 57 32 16 26 26 79 33 27 98 \
66\n88 36 68 87 57 62 20 72 03 46 33 67 46 55 12 32 63 93 53 69\n04 42 16 73 \
38 25 39 11 24 94 72 18 08 46 29 32 40 62 76 36\n20 69 36 41 72 30 23 88 34 \
62 99 69 82 67 59 85 74 04 36 16\n20 73 35 29 78 31 90 01 74 31 49 71 48 86 \
81 16 23 57 05 54\n01 70 54 71 83 51 54 69 16 92 33 48 61 43 52 01 89 19 67 \
48",
    SelectWithContents->True,
    Selectable->False]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grid", "=", 
   RowBox[{"Apply", "[", 
    RowBox[{"List", ",", 
     RowBox[{"\"\<{{\>\"", "<>", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"s", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<\\n\>\"", "->", "\"\<},{\>\""}], ",", 
          RowBox[{"\"\< \>\"", "->", "\"\<,\>\""}]}], "}"}]}], "]"}], "<>", 
      "\"\<}}\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"lg", "=", 
  RowBox[{"ToExpression", "[", "grid", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "this", " ", "frame", " ", "imports", " ", "the", " ", "number", " ", 
     "as", " ", "a", " ", "matrix"}], ",", 
    RowBox[{
    "since", " ", "the", " ", "copied", " ", "version", " ", "is", " ", "not",
      " ", "in", " ", "rows"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9507725836118774`*^9, 3.950772649530915*^9}, {
  3.9508294715368*^9, 3.950829472637535*^9}, {3.9508295427788143`*^9, 
  3.9508296023414536`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"71e09af7-ea21-f146-ad19-0932dfa60364"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "8", ",", "2", ",", "22", ",", "97", ",", "38", ",", "15", ",", "0", ",", 
     "40", ",", "0", ",", "75", ",", "4", ",", "5", ",", "7", ",", "78", ",", 
     "52", ",", "12", ",", "50", ",", "77", ",", "91", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "49", ",", "49", ",", "99", ",", "40", ",", "17", ",", "81", ",", "18", 
     ",", "57", ",", "60", ",", "87", ",", "17", ",", "40", ",", "98", ",", 
     "43", ",", "69", ",", "48", ",", "4", ",", "56", ",", "62", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "81", ",", "49", ",", "31", ",", "73", ",", "55", ",", "79", ",", "14", 
     ",", "29", ",", "93", ",", "71", ",", "40", ",", "67", ",", "53", ",", 
     "88", ",", "30", ",", "3", ",", "49", ",", "13", ",", "36", ",", "65"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "52", ",", "70", ",", "95", ",", "23", ",", "4", ",", "60", ",", "11", 
     ",", "42", ",", "69", ",", "24", ",", "68", ",", "56", ",", "1", ",", 
     "32", ",", "56", ",", "71", ",", "37", ",", "2", ",", "36", ",", "91"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "22", ",", "31", ",", "16", ",", "71", ",", "51", ",", "67", ",", "63", 
     ",", "89", ",", "41", ",", "92", ",", "36", ",", "54", ",", "22", ",", 
     "40", ",", "40", ",", "28", ",", "66", ",", "33", ",", "13", ",", "80"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "24", ",", "47", ",", "32", ",", "60", ",", "99", ",", "3", ",", "45", 
     ",", "2", ",", "44", ",", "75", ",", "33", ",", "53", ",", "78", ",", 
     "36", ",", "84", ",", "20", ",", "35", ",", "17", ",", "12", ",", "50"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "32", ",", "98", ",", "81", ",", "28", ",", "64", ",", "23", ",", "67", 
     ",", "10", ",", "26", ",", "38", ",", "40", ",", "67", ",", "59", ",", 
     "54", ",", "70", ",", "66", ",", "18", ",", "38", ",", "64", ",", "70"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "67", ",", "26", ",", "20", ",", "68", ",", "2", ",", "62", ",", "12", 
     ",", "20", ",", "95", ",", "63", ",", "94", ",", "39", ",", "63", ",", 
     "8", ",", "40", ",", "91", ",", "66", ",", "49", ",", "94", ",", "21"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "24", ",", "55", ",", "58", ",", "5", ",", "66", ",", "73", ",", "99", 
     ",", "26", ",", "97", ",", "17", ",", "78", ",", "78", ",", "96", ",", 
     "83", ",", "14", ",", "88", ",", "34", ",", "89", ",", "63", ",", "72"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "21", ",", "36", ",", "23", ",", "9", ",", "75", ",", "0", ",", "76", ",",
      "44", ",", "20", ",", "45", ",", "35", ",", "14", ",", "0", ",", "61", 
     ",", "33", ",", "97", ",", "34", ",", "31", ",", "33", ",", "95"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "78", ",", "17", ",", "53", ",", "28", ",", "22", ",", "75", ",", "31", 
     ",", "67", ",", "15", ",", "94", ",", "3", ",", "80", ",", "4", ",", 
     "62", ",", "16", ",", "14", ",", "9", ",", "53", ",", "56", ",", "92"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "16", ",", "39", ",", "5", ",", "42", ",", "96", ",", "35", ",", "31", 
     ",", "47", ",", "55", ",", "58", ",", "88", ",", "24", ",", "0", ",", 
     "17", ",", "54", ",", "24", ",", "36", ",", "29", ",", "85", ",", "57"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "86", ",", "56", ",", "0", ",", "48", ",", "35", ",", "71", ",", "89", 
     ",", "7", ",", "5", ",", "44", ",", "44", ",", "37", ",", "44", ",", 
     "60", ",", "21", ",", "58", ",", "51", ",", "54", ",", "17", ",", "58"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "19", ",", "80", ",", "81", ",", "68", ",", "5", ",", "94", ",", "47", 
     ",", "69", ",", "28", ",", "73", ",", "92", ",", "13", ",", "86", ",", 
     "52", ",", "17", ",", "77", ",", "4", ",", "89", ",", "55", ",", "40"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4", ",", "52", ",", "8", ",", "83", ",", "97", ",", "35", ",", "99", ",",
      "16", ",", "7", ",", "97", ",", "57", ",", "32", ",", "16", ",", "26", 
     ",", "26", ",", "79", ",", "33", ",", "27", ",", "98", ",", "66"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "88", ",", "36", ",", "68", ",", "87", ",", "57", ",", "62", ",", "20", 
     ",", "72", ",", "3", ",", "46", ",", "33", ",", "67", ",", "46", ",", 
     "55", ",", "12", ",", "32", ",", "63", ",", "93", ",", "53", ",", "69"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4", ",", "42", ",", "16", ",", "73", ",", "38", ",", "25", ",", "39", 
     ",", "11", ",", "24", ",", "94", ",", "72", ",", "18", ",", "8", ",", 
     "46", ",", "29", ",", "32", ",", "40", ",", "62", ",", "76", ",", "36"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "20", ",", "69", ",", "36", ",", "41", ",", "72", ",", "30", ",", "23", 
     ",", "88", ",", "34", ",", "62", ",", "99", ",", "69", ",", "82", ",", 
     "67", ",", "59", ",", "85", ",", "74", ",", "4", ",", "36", ",", "16"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "20", ",", "73", ",", "35", ",", "29", ",", "78", ",", "31", ",", "90", 
     ",", "1", ",", "74", ",", "31", ",", "49", ",", "71", ",", "48", ",", 
     "86", ",", "81", ",", "16", ",", "23", ",", "57", ",", "5", ",", "54"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "70", ",", "54", ",", "71", ",", "83", ",", "51", ",", "54", 
     ",", "69", ",", "16", ",", "92", ",", "33", ",", "48", ",", "61", ",", 
     "43", ",", "52", ",", "1", ",", "89", ",", "19", ",", "67", ",", "48"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9507726201271*^9, 3.950772678372732*^9, 
  3.9507773551108284`*^9, 3.950829478262757*^9, 3.9508307064212627`*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"8151ed3e-7662-3f49-b0d9-c3f19724ec30"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tc", "[", 
    RowBox[{"i_Integer", ",", "j_Integer"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"(*", 
       RowBox[{
       "get", " ", "the", " ", "product", " ", "of", " ", "the", " ", 
        "diagonal", " ", "elements"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Diagonal", "[", 
       RowBox[{"(*", 
        RowBox[{
        "takes", " ", "the", " ", "diagonal", " ", "as", " ", "a", " ", 
         "list"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"#", "/@", 
        RowBox[{"(*", 
         RowBox[{
         "the", " ", "reverse", " ", "and", " ", "identity", " ", "of", " ", 
          "the", " ", "submatrix"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lg", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"i", ";;", 
            RowBox[{"i", "+", "3"}]}], ",", 
           RowBox[{"j", ";;", 
            RowBox[{"j", "+", "3"}]}]}], "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"Reverse", ",", "Identity"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dia", "=", 
    RowBox[{"Max", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"tc", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "17"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "17"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "makes", " ", "a", " ", "table", " ", "and", " ", "selects", " ", "the", 
    " ", "max", " ", "element", " ", "in", " ", "the", " ", "diagonal", " ", 
    "products"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vet", "=", 
    RowBox[{"Max", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Times", "@@", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", 
             RowBox[{"j", ";;", 
              RowBox[{"j", "+", "3"}]}]}], "]"}], "]"}]}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"lg", ",", 
          RowBox[{"Transpose", "@", "lg"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "20"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "17"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"similar", " ", "as", " ", "above"}], ",", " ", 
    RowBox[{
    "just", " ", "applying", " ", "the", " ", "rules", " ", "for", " ", 
     "rows", " ", "and", " ", "columns"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Max", "[", 
  RowBox[{"dia", ",", "vet"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9508293096303864`*^9, 3.9508293968264484`*^9}, {
  3.950829606927063*^9, 3.9508297305501537`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"9e28d54d-6228-824e-b70e-228ff2c7aeb0"],

Cell[BoxData["70600674"], "Output",
 CellChangeTimes->{3.9508307103278484`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"f57f4180-8cd4-1f4f-b217-89c1ef4f1e81"]
}, Open  ]],

Cell["By Tommy@https://github.com/Tommy-Alkyne", "Text",
 CellChangeTimes->{{3.950830722109541*^9, 
  3.9508307281842194`*^9}},ExpressionUUID->"5b7a4cbc-633c-1b4e-985f-\
a9c99cacef7d"]
}, Open  ]]
},
WindowSize->{950.25, 527.625},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (2023\:5e7412\:670812\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"09ed5257-1915-f842-bd6f-d4a880135517"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 185, 3, 53, "Subtitle",ExpressionUUID->"5375cdb0-f16a-7c48-91d5-babd7a532756"],
Cell[768, 27, 253, 6, 35, "Text",ExpressionUUID->"554fe388-7949-4b44-b581-0483b238dbf1"],
Cell[CellGroupData[{
Cell[1046, 37, 3299, 68, 144, "Input",ExpressionUUID->"71e09af7-ea21-f146-ad19-0932dfa60364"],
Cell[4348, 107, 5838, 124, 394, "Output",ExpressionUUID->"8151ed3e-7662-3f49-b0d9-c3f19724ec30"]
}, Closed]],
Cell[CellGroupData[{
Cell[10223, 236, 2916, 82, 273, "Input",ExpressionUUID->"9e28d54d-6228-824e-b70e-228ff2c7aeb0"],
Cell[13142, 320, 157, 2, 32, "Output",ExpressionUUID->"f57f4180-8cd4-1f4f-b217-89c1ef4f1e81"]
}, Open  ]],
Cell[13314, 325, 184, 3, 35, "Text",ExpressionUUID->"5b7a4cbc-633c-1b4e-985f-a9c99cacef7d"]
}, Open  ]]
}
]
*)

